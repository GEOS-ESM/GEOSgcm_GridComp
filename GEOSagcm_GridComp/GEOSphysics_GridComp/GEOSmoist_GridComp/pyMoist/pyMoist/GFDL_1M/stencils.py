def calculate_derived_states()